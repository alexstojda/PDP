package system.authz

default allow = false                       # Reject requests by default.

allow {                                     # Allow request if...
    "{{ bearer_token }}" == input.identity  # Identity is the secret root key.
}

allow {
    "/v1/data/system/opal/healthy" == input.request.http.path
}

allow {
    "/v1/data/system/opal" == input.request.http.path
}

allow {
    "/v1/data/system/opal/ready" == input.request.http.path
}